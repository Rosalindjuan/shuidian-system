webpackJsonp([11],{"k+Pv":function(e,t){},pSIG:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("Dd8w"),s=r.n(o),a=r("D4TX"),n=r("gyMJ"),i=r("NYxO"),l={components:{Crumbs:a.a},data:function(){return{form:{name:"",tel:"",remarks:"",address:""},dialogVisible:!1,rules:{name:[{required:!0,message:"请输入客户姓名",trigger:"blur"}],tel:[{required:!0,message:"请输入电话号码",trigger:"blur"}],address:[{required:!0,message:"请输入客户住址",trigger:"blur"}]},goodsList:[],repay:{repayMoney:"",repayTime:""},repayList:[]}},computed:{currentAmount:function(){var e=0;return this.goodsList.map(function(t){e+=t.stock_price*t.stock_num}),e},perAmount:function(){this.goodsList.map(function(e){return e.stock_price=+e.stock_price,e.stock_num=+e.stock_num,e.stock_amount=e.stock_price*e.stock_num})}},methods:s()({},Object(i.b)(["TOSAST_STATE"]),{addGoods:function(){},onSubmitCus:function(){var e=this;this.$refs.rulesform.validate(function(t){if(!t)return!1;var r=JSON.parse(localStorage.getItem("userInfo")),o={token:r.token,username:r.user,id:e.$route.params.id,form:e.form};Object(n.t)(o).then(function(t){e.TOSAST_STATE({text:t.msg}),2==t.errcode&&setTimeout(function(){localStorage.removeItem("userInfo"),e.$router.push("/login")},1e3)})})},onSubmitGoods:function(){var e=this,t=JSON.parse(localStorage.getItem("userInfo")),r={token:t.token,username:t.user,id:this.$route.params.id,goodsList:this.goodsList};Object(n.s)(r).then(function(t){e.TOSAST_STATE({text:t.msg}),2==t.errcode&&setTimeout(function(){localStorage.removeItem("userInfo"),e.$router.push("/login")},1e3)})},judgeRepayMoney:function(){return!!this.repay.repayMoney||(this.TOSAST_STATE({text:"请输入付款金额"}),!1)},judgeRepayTime:function(){return!!this.repay.repayTime||(this.TOSAST_STATE({text:"请选择付款日期"}),!1)},addRepay:function(){var e=this;if(this.judgeRepayMoney()&&this.judgeRepayTime()){console.log(this.judgeRepayMoney&&this.judgeRepayTime);var t=JSON.parse(localStorage.getItem("userInfo")),r={token:t.token,username:t.user,id:this.$route.params.id,amount:this.repay.repayMoney,time:this.repay.repayTime};Object(n.a)(r).then(function(t){e.TOSAST_STATE({text:t.msg}),t.errcode?2==t.errcode&&setTimeout(function(){localStorage.removeItem("userInfo"),e.$router.push("/login")},1e3):(e.repayList.push({amount:e.repay.repayMoney,time:e.repay.repayTime}),e.repay.repayMoney="",e.repay.repayTime="")})}}}),created:function(){var e=this,t=JSON.parse(localStorage.getItem("userInfo")),r={params:{id:this.$route.params.id,token:t.token,username:t.user}};Object(n.g)(r).then(function(t){console.log(t),t.errcode?(e.TOSAST_STATE({text:t.msg}),2==t.errcode&&setTimeout(function(){localStorage.removeItem("userInfo"),e.$router.push("/login")},1e3)):(e.form=t.data.info,e.goodsList=t.data.goods_list,e.repayList=t.data.repay_list)})}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Crumbs",{attrs:{crumbs1:"客户",crumbs2:"客户详情"}}),e._v(" "),r("div",{staticClass:"plugins-tips"},[e._v("客户基本信息")]),e._v(" "),r("div",{staticClass:"form-box"},[r("el-form",{ref:"rulesform",attrs:{"label-width":"100px",model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"姓名"}},[e._v(e._s(e.form.name))]),e._v(" "),r("el-form-item",{attrs:{label:"电话号码",prop:"tel"}},[r("el-input",{model:{value:e.form.tel,callback:function(t){e.$set(e.form,"tel",t)},expression:"form.tel"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"住址",prop:"address"}},[r("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitCus}},[e._v("保存")])],1)],1)],1),e._v(" "),r("br"),e._v(" "),r("div",{staticClass:"plugins-tips"},[e._v("还款信息")]),e._v(" "),r("ul",{staticClass:"repay-info form-box"},[r("li",{staticClass:"amount"},[e._v("应还款总额： "),r("span",[e._v(e._s(e.currentAmount))]),e._v("元")]),e._v(" "),r("li",[e._m(0),e._v(" "),e._l(e.repayList,function(t,o){return r("ul",{key:o},[r("li",[e._v(e._s(t.amount))]),e._v(" "),r("li",[e._v(e._s(t.time))])])}),e._v(" "),r("ul",[r("li",[r("el-input",{attrs:{placeholder:"输入付款金额"},model:{value:e.repay.repayMoney,callback:function(t){e.$set(e.repay,"repayMoney",t)},expression:"repay.repayMoney"}})],1),e._v(" "),r("li",[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.repay.repayTime,callback:function(t){e.$set(e.repay,"repayTime",t)},expression:"repay.repayTime"}})],1)]),e._v(" "),r("ul",[r("li",{staticClass:"add-btn"},[r("el-button",{attrs:{type:"primary"},on:{click:e.addRepay}},[e._v("添加")])],1)])],2)]),e._v(" "),r("div",{staticClass:"plugins-tips"},[e._v("客户用到的物料列表")]),e._v(" "),r("div",{staticClass:"form-box"},[r("el-form",[r("el-form-item",[r("el-table",{attrs:{data:e.goodsList}},[r("el-table-column",{attrs:{type:"index"}}),e._v(" "),r("el-table-column",{attrs:{prop:"stock_name",label:"名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"stock_num",label:"数量",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{model:{value:t.row.stock_num,callback:function(r){e.$set(t.row,"stock_num",r)},expression:"scope.row.stock_num"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"stock_price",label:"单价",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{model:{value:t.row.stock_price,callback:function(r){e.$set(t.row,"stock_price",r)},expression:"scope.row.stock_price"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"金额",prop:"stock_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.perAmount)+"\n              "+e._s(t.row.stock_num*t.row.stock_price)+"\n            ")]}}])})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitGoods}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加物料")])],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("付款金额(￥)")]),this._v(" "),t("li",[this._v("付款时间")])])}]};var c=r("VU/8")(l,u,!1,function(e){r("k+Pv")},"data-v-1cef07eb",null);t.default=c.exports}});
//# sourceMappingURL=11.97d3d19e021a0fc10f2b.js.map